!function(){"use strict";var e={243:function(e,t,r){e.exports=r.p+"d3edfb3fe0284e46cb86.jpg"},769:function(e,t,r){e.exports=r.p+"05f1a4a8dccb609a7ff3.jpg"},199:function(e,t,r){e.exports=r.p+"4317d98e0be2323014f4.jpg"},408:function(e,t,r){e.exports=r.p+"c699805af844af80a2db.jpg"},462:function(e,t,r){e.exports=r.p+"0bbb8e918e3becd29120.jpg"},329:function(e,t,r){e.exports=r.p+"205114d203f083e3e22b.jpg"}},t={};function r(s){var o=t[s];if(void 0!==o)return o.exports;var n=t[s]={exports:{}};return e[s](n,n.exports,r),n.exports}r.p="",function(){class e{constructor(e,t){this._config=e,this._formElement=t}enableValidation(){this.setEventListeners()}setEventListeners(){this._inputs=this._formElement.querySelectorAll(this._config.inputSelector),this._submitBtn=this._formElement.querySelector(this._config.submitButtonSelector),this._inputs.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e,this._formElement),this._updateSubmitButton()}))}))}_updateSubmitButton(){const e=this._checkFieldsValidity(this._inputs);this._setSubmitButtonState(e)}_setSubmitButtonState(e){this._submitBtn.disabled=e}_checkFieldsValidity(){return Array.from(this._inputs).some((e=>!e.validity.valid))}_checkInputValidity(e){e.validity.valid?(this._removeErrorStyles(e),this._hideErrorMessage(e)):(this._addErrorStyles(e),this._showErrorMessage(e))}_removeErrorStyles(e){e.classList.remove(this._config.inputHasError)}_hideErrorMessage(e){this._formElement.querySelector(".".concat(e.id,"-error")).classList.remove(this._config.errorTextVisible)}_addErrorStyles(e){e.classList.add(this._config.inputHasError)}_showErrorMessage(e){const t=this._formElement.querySelector(".".concat(e.id,"-error"));t.textContent=e.validationMessage,t.classList.add(this._config.errorTextVisible)}resetValidation(){this._updateSubmitButton(),this._inputs.forEach((e=>{this._hideErrorMessage(e),this._removeErrorStyles(e)}))}}class t{constructor(e,t){let{data:r,handleCardClick:s,handleTrashClick:o}=e;this._template=document.querySelector("#".concat(t)),this._data=r,this._handleCardClick=s,this._handleTrashClick=o}createCard(){this._card=this._template.content.cloneNode(!0).querySelector(".element");const e=this._card.querySelector(".element__title"),t=this._card.querySelector(".element__image");return t.src=this._data.url,t.alt=this._data.title,e.textContent=this._data.title,this._setEventListeners(),this._card}_setEventListeners(){this._card.querySelector(".element__image").addEventListener("click",(e=>{this._handleCardClick(e)})),this._card.querySelector("#delete-card-button").addEventListener("click",(()=>{this._handleTrashClick()})),this._card.querySelector(".like-button").addEventListener("click",(()=>{this._toggleLike()}))}_toggleLike(){this._card.querySelector(".like-button").classList.toggle("like-button_active")}}class s{constructor(e){this._popupElement=document.querySelector("#".concat(e)),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popupElement.classList.add("popup-form_open"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("popup-form_open"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._popupElement.addEventListener("click",(e=>{(e.target===this._popupElement||e.target.classList.contains("close-button"))&&this.close()}))}}class o extends s{constructor(e){let{popupSelector:t,handleFormSubmit:r}=e;super(t),this._form=this._popupElement.querySelector(".popup-form__input-container"),this._formInputs=this._popupElement.querySelectorAll(".popup-form__input"),this._handleFormSubmit=r}_getInputValues(){return this._formValues={},this._formInputs.forEach((e=>{this._formValues[e.name]=e.value})),this._formValues}setEventListeners(){super.setEventListeners(),this._popupElement.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues()),this.close()}))}resetForm(){this._form.reset()}}const n=[{title:"Palm Springs Aerial Tramway",url:r(199)},{title:"Cedar Point, OH",url:r(769)},{title:"N.A. Pow Wows",url:r(462)},{title:"Colonial Williamsburg",url:r(243)},{title:"Old San Juan, Puerto Rico",url:r(408)},{title:"Disney World",url:r(329)}],i={formSelector:".popup-form__input-container",inputSelector:".popup-form__input",submitButtonSelector:".submit-button",inactiveButtonClass:"popup-form__submit-button_type_disabled",errorTextSelector:".popup-form__error-text",inputHasError:"popup-form__input_has_error",errorTextVisible:"popup-form__error-text_visible"},a=document.querySelector("#edit-button"),l=document.querySelector(".add-button"),c=document.querySelector("#profile-pic-button"),d=document.querySelector("#name"),u=document.querySelector("#description"),p=document.querySelector("#profile-pic"),h=(new class{constructor(e){let{baseUrl:t,headers:r}=e;this._baseUrl=t,this._headers=r}_handleServerResponse(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}getUserInfo(){fetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers}).then(this._handleServerResponse)}setUserInfo(e){let{name:t,description:r}=e;return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,description:r})}).then(this._handleServerResponse)}updateProfilePicture(e){let{avatar:t}=e;return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:t})}).then(this._handleServerResponse)}getInitialCardList(e){let{title:t,url:r}=e;return fetch("".concat(this._baseUrl,"/cards"),{method:"GET",body:JSON.stringify({title:t,url:r}).then(this._handleServerResponse)})}addCard(e){let{title:t,url:r}=e;return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({title:t,url:r}).then(this._handleServerResponse)})}removeCard(e){let{_id:t}=e;return fetch("".concat(this._baseUrl,"/cards/cardId"),{method:"DELETE",headers:this._headers,body:JSON.stringify({_id:t}).then(this._handleServerResponse)})}toggleLikeCardStatus(e,t){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:t?"PUT":"DELETE",headers:this._headers}).then(this._handleServerResponse)}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"9b991f86-368d-4ef3-963c-b91580821c46","Content-Type":"application/json"}}),new class extends s{open(e){let{url:t,title:r}=e;this._popupElement.querySelector(".popup-form__caption").textContent=r,this._imgElement=this._popupElement.querySelector(".popup-form__image"),this._imgElement.src=t,this._imgElement.alt=r,super.open()}}("image-popup")),m=e=>new t({data:e,handleCardClick:()=>{h.open(e)},handleTrashClick:()=>{b.open()}},"card-template").createCard(),_=new class{constructor(e,t){let{items:r,renderer:s}=e;this._items=r,this._renderer=s,this._container=document.querySelector(".".concat(t))}renderItem(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({items:n,renderer:e=>{_.addItem(m(e))}},"elements"),f=new class{constructor(e){let{nameSelector:t,descriptionSelector:r}=e;this._nameElement=document.querySelector(".".concat(t)),this._descriptionElement=document.querySelector(".".concat(r))}getUserInfo(){return{name:this._nameElement.textContent,description:this._descriptionElement.textContent}}setUserInfo(e){let{name:t,description:r}=e;this._nameElement.textContent=t,this._descriptionElement.textContent=r}}({nameSelector:"profile__name",descriptionSelector:"profile__description"}),S=new o({popupSelector:"edit-popup-form",handleFormSubmit:e=>{f.setUserInfo(e)}}),E=new o({popupSelector:"create-popup-form",handleFormSubmit:e=>{_.addItem(m(e)),E.resetForm()}}),b=new class extends s{constructor(e){let{popupSelector:t}=e;super(t)}setEventListeners(){super.setEventListeners(),document.querySelector("#confirmation-button").addEventListener("click",(()=>{this.deleteCard(),this.close()}))}deleteCard(){document.querySelector(".element").remove()}}({popupSelector:"delete-confirmation-popup"}),v=new o({popupSelector:"profile-picture-popup",handleFormSubmit:()=>{document.querySelector(".profile__image").src=p.value,v.resetForm()}}),y=new e(i,document.querySelector("#edit-popup-form"));y.enableValidation();const g=new e(i,document.querySelector("#create-popup-form"));g.enableValidation();const L=new e(i,document.querySelector("#profile-picture-popup"));L.enableValidation(),a.addEventListener("click",(()=>{S.open();const{name:e,description:t}=f.getUserInfo();d.value=e,u.value=t,y.resetValidation()})),l.addEventListener("click",(()=>{E.resetForm(),g.resetValidation(),E.open()})),c.addEventListener("click",(()=>{L.resetValidation(),v.open()})),_.renderItem(n),h.setEventListeners(),S.setEventListeners(),E.setEventListeners(),b.setEventListeners(),v.setEventListeners()}()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QTlCLFNBQVNyQyxjQUFjLG1CQUMvQitDLElBQU0yQyxFQUFhZixNQUMzQnFFLEVBQW9CbkUsZUFJbEJvRSxFQUF1QixJQUFJOUosRUFDL0I4RixFQUNBNUMsU0FBU3JDLGNBQWMscUJBRXpCaUosRUFBcUJ2SixtQkFFckIsTUFBTXdKLEVBQXNCLElBQUkvSixFQUM5QjhGLEVBQ0E1QyxTQUFTckMsY0FBYyx1QkFFekJrSixFQUFvQnhKLG1CQUVwQixNQUFNeUosRUFBc0IsSUFBSWhLLEVBQzlCOEYsRUFDQTVDLFNBQVNyQyxjQUFjLDJCQUV6Qm1KLEVBQW9CekosbUJBRXBCMkYsRUFBa0JqRixpQkFBaUIsU0FBUyxLQUMxQ3lJLEVBQXFCbEYsT0FDckIsTUFBTSxLQUFDZSxFQUFELFlBQU9pQyxHQUFlNkIsRUFBU2pDLGNBQ3JDZixFQUFVYixNQUFRRCxFQUNsQmUsRUFBU2QsTUFBUWdDLEVBQ2pCc0MsRUFBcUJuSCxxQkFHdkJ3RCxFQUFjbEYsaUJBQWlCLFNBQVMsS0FDdEMwSSxFQUFvQmpFLFlBQ3BCcUUsRUFBb0JwSCxrQkFDcEJnSCxFQUFvQm5GLFVBR3RCNEIsRUFBcUJuRixpQkFBaUIsU0FBUyxLQUM3QytJLEVBQW9Cckgsa0JBQ3BCa0gsRUFBb0JyRixVQUl0QmlFLEVBQVNPLFdBQVdwRCxHQUNwQlksRUFBV2hHLG9CQUNYa0osRUFBcUJsSixvQkFDckJtSixFQUFvQm5KLG9CQUNwQmdJLEVBQXVCaEksb0JBQ3ZCcUosRUFBb0JySixvQiIsInNvdXJjZXMiOlsid2VicGFjazovL3dlYl9wcm9qZWN0XzQvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC93ZWJwYWNrL3J1bnRpbWUvcHVibGljUGF0aCIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy91dGlscy9Db25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9wYWdlL2luZGV4LmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRGVsZXRlQ29uZmlybS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiX193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjsiLCIvLyBGb3JtIFZhbGlkYXRpb24gY2xhc3MgY29kZVxuXG4vLyBcImNvbmZpZ1wiID0gYXJyYXkgb2Ygc2VsZWN0b3JzICYgXCJmb3JtRWxlbWVudFwiID0gZm9ybVxuZXhwb3J0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3Rvcihjb25maWcsIGZvcm1FbGVtZW50KSB7XG4gICAgdGhpcy5fY29uZmlnID0gY29uZmlnO1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XG4gIH1cblxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIC8vIGFkZCBldmVudCBsaXN0ZW5lciBmdW5jdGlvbjogaXQgd2lsbCB1c2UgcGFyYW1ldGVycyBmb3JtIGFuZCBzZXR0aW5ncy5cbiAgLy8gc2VsZWN0IGFsbCBvZiB0aGUgaW5wdXRzXG4gIC8vLyB3YW50IHRvIHNlbGVjdCBzdWJtaXQgYnV0dG9uIGluIHRocyBmeCB0b29cbiAgLy8vIGFkZCBhIHBhcnQgdGhhdCBoYXMgYSBjb25kaXRpb24gd2hlcmUgdGhlcmUgaXMgYW4gZXJyb3IgYW5kIHdoYXQgdG8gZG8gdGhlblxuICAvLy8gYWRkIGJ1dHRvbiBkaXNhYmxlIHRvZ2dsZVxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9pbnB1dHMgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKFxuICAgICAgdGhpcy5fY29uZmlnLmlucHV0U2VsZWN0b3JcbiAgICApO1xuICAgIHRoaXMuX3N1Ym1pdEJ0biA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICB0aGlzLl9jb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3JcbiAgICApO1xuICAgIC8vY2hlY2tzIGluIHB1dCB2YWxpZGl0eSAmIGNoZWNrIGFsbCBpbnB1dHMgZm9yIHZhbGlkaXR5XG4gICAgdGhpcy5faW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKGV2dCkgPT4ge1xuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXQsIHRoaXMuX2Zvcm1FbGVtZW50KTtcbiAgICAgICAgdGhpcy5fdXBkYXRlU3VibWl0QnV0dG9uKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIF91cGRhdGVTdWJtaXRCdXR0b24oKSB7XG4gICAgY29uc3QgaGFzRXJyb3JzID0gdGhpcy5fY2hlY2tGaWVsZHNWYWxpZGl0eSh0aGlzLl9pbnB1dHMpO1xuICAgIHRoaXMuX3NldFN1Ym1pdEJ1dHRvblN0YXRlKGhhc0Vycm9ycyk7XG4gIH1cblxuICAvLyB0b2dnbGVzIHRoZSBidXR0b24gYmV0d2VlbiBkaXNhYmxlZCBhbmQgZW5hYmxlZFxuICBfc2V0U3VibWl0QnV0dG9uU3RhdGUoaGFzRXJyb3JzKSB7XG4gICAgdGhpcy5fc3VibWl0QnRuLmRpc2FibGVkID0gaGFzRXJyb3JzO1xuICB9XG5cbiAgLy8gdHVybiBpbnB1dHMgaW50byBhbiBhcnJheSwgdGFrZSBzb21lIGlucHV0OyByZXR1cm4gc29sdXRpb24gaWYgaW5wdXQgaXMgaW52YWxpZFxuICBfY2hlY2tGaWVsZHNWYWxpZGl0eSgpIHtcbiAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLl9pbnB1dHMpLnNvbWUoKGlucHV0KSA9PiAhaW5wdXQudmFsaWRpdHkudmFsaWQpO1xuICB9XG5cbiAgLy8gcmVtb3Zlcy9oaWRlcyBlcnJvcnMgaWYgaW5wdXRzIGFyZSB2YWxpZFxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0KSB7XG4gICAgaWYgKGlucHV0LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICB0aGlzLl9yZW1vdmVFcnJvclN0eWxlcyhpbnB1dCk7XG4gICAgICB0aGlzLl9oaWRlRXJyb3JNZXNzYWdlKGlucHV0KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fYWRkRXJyb3JTdHlsZXMoaW5wdXQpO1xuICAgICAgdGhpcy5fc2hvd0Vycm9yTWVzc2FnZShpbnB1dCk7XG4gICAgfVxuICB9XG5cbiAgX3JlbW92ZUVycm9yU3R5bGVzKGlucHV0KSB7XG4gICAgaW5wdXQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9jb25maWcuaW5wdXRIYXNFcnJvcik7XG4gIH1cblxuICBfaGlkZUVycm9yTWVzc2FnZShpbnB1dCkge1xuICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYC4ke2lucHV0LmlkfS1lcnJvcmBcbiAgICApO1xuICAgIGVycm9yTWVzc2FnZUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9jb25maWcuZXJyb3JUZXh0VmlzaWJsZSk7XG4gIH1cblxuICBfYWRkRXJyb3JTdHlsZXMoaW5wdXQpIHtcbiAgICBpbnB1dC5jbGFzc0xpc3QuYWRkKHRoaXMuX2NvbmZpZy5pbnB1dEhhc0Vycm9yKTtcbiAgfVxuXG4gIF9zaG93RXJyb3JNZXNzYWdlKGlucHV0KSB7XG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBgLiR7aW5wdXQuaWR9LWVycm9yYFxuICAgICk7XG4gICAgZXJyb3JNZXNzYWdlRWxlbWVudC50ZXh0Q29udGVudCA9IGlucHV0LnZhbGlkYXRpb25NZXNzYWdlO1xuICAgIGVycm9yTWVzc2FnZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9jb25maWcuZXJyb3JUZXh0VmlzaWJsZSk7XG4gIH1cblxuICByZXNldFZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fdXBkYXRlU3VibWl0QnV0dG9uKCk7XG5cbiAgICB0aGlzLl9pbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIHRoaXMuX2hpZGVFcnJvck1lc3NhZ2UoaW5wdXQpO1xuICAgICAgdGhpcy5fcmVtb3ZlRXJyb3JTdHlsZXMoaW5wdXQpO1xuICAgIH0pO1xuICB9XG59XG5cbi8vIHRvIGNoZWNrIHRvIHNlZSBpZiBzb21ldGhpbmcgaXMgYmVpbmcgZ3JhYmJlZCBjb3JyZWN0bHlcbi8vLyB2aWEgZGV2IHRvb2xzOiBpLmUuIHR5cGUgXCJpbnB1dC5pZFwiIHRvIHNlZSB3aGljaCBpbnB1dCBmdW5jdGlvbiBpcyBncmFiYmluZ1xuIiwiZXhwb3J0IGNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3Rvcih7IGRhdGEsIGhhbmRsZUNhcmRDbGljaywgaGFuZGxlVHJhc2hDbGlja30sIHRlbXBsYXRlU2VsZWN0b3IpIHtcbiAgICB0aGlzLl90ZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke3RlbXBsYXRlU2VsZWN0b3J9YCk7XG4gICAgdGhpcy5fZGF0YSA9IGRhdGE7XG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xuICAgIHRoaXMuX2hhbmRsZVRyYXNoQ2xpY2sgPSBoYW5kbGVUcmFzaENsaWNrO1xuICB9XG5cbiAgY3JlYXRlQ2FyZCgpIHtcbiAgICB0aGlzLl9jYXJkID0gdGhpcy5fdGVtcGxhdGUuY29udGVudC5jbG9uZU5vZGUodHJ1ZSkucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50XCIpO1xuICAgXG4gICAgY29uc3QgdGl0bGVFbGVtZW50ID0gdGhpcy5fY2FyZC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX3RpdGxlXCIpO1xuICAgIGNvbnN0IGltZ0VsZW1lbnQgPSB0aGlzLl9jYXJkLnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9faW1hZ2VcIik7XG5cbiAgICBpbWdFbGVtZW50LnNyYyA9IHRoaXMuX2RhdGEudXJsO1xuICAgIGltZ0VsZW1lbnQuYWx0ID0gdGhpcy5fZGF0YS50aXRsZTtcbiAgICB0aXRsZUVsZW1lbnQudGV4dENvbnRlbnQgPSB0aGlzLl9kYXRhLnRpdGxlO1xuXG4gICAgLy8gY2xpY2sgb24gaW1nIHRvIG9wZW4gaW1nIG1vZGFsIChjYXVzZXMgaW5pdGlhbCBjYXJkcyBub3QgdG8gc2hvdyB1cClcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuXG4gICAgcmV0dXJuIHRoaXMuX2NhcmQ7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7ICBcbiAgICBjb25zdCBpbWdFbGVtZW50ID0gdGhpcy5fY2FyZC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX2ltYWdlXCIpO1xuXG4gICAgaW1nRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGRhdGEpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayhkYXRhKTtcbiAgICB9KTtcblxuICAgIHRoaXMuX2NhcmQucXVlcnlTZWxlY3RvcihcIiNkZWxldGUtY2FyZC1idXR0b25cIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZVRyYXNoQ2xpY2soKTtcbiAgICB9KTtcblxuICAgIC8vIGxpa2UvdW5saWtlIGJ1dHRvblxuICAgIHRoaXMuX2NhcmQucXVlcnlTZWxlY3RvcihcIi5saWtlLWJ1dHRvblwiKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5fdG9nZ2xlTGlrZSgpO1xuICAgIH0pO1xuICB9XG5cbiAgX3RvZ2dsZUxpa2UoKSB7XG4gICAgdGhpcy5fY2FyZC5xdWVyeVNlbGVjdG9yKFwiLmxpa2UtYnV0dG9uXCIpLmNsYXNzTGlzdC50b2dnbGUoXCJsaWtlLWJ1dHRvbl9hY3RpdmVcIik7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke3BvcHVwU2VsZWN0b3J9YCk7XG4gICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xuICB9XG5cbiAgb3BlbigpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInBvcHVwLWZvcm1fb3BlblwiKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwLWZvcm1fb3BlblwiKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBfaGFuZGxlRXNjQ2xvc2UoZSkge1xuICAgIGlmIChlLmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIC8vIGlmIGNsaWNrIG91dHNpZGUgcG9wdXAgb3IgY2xpY2sgb24geCBidXR0b24sIGNsb3NlIHBvcHVwLlxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICAgIGlmIChlLnRhcmdldCA9PT0gdGhpcy5fcG9wdXBFbGVtZW50IHx8IGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcImNsb3NlLWJ1dHRvblwiKSkge1xuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0IH0pIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXAtZm9ybV9faW5wdXQtY29udGFpbmVyXCIpO1xuICAgIHRoaXMuX2Zvcm1JbnB1dHMgPVxuICAgICAgdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucG9wdXAtZm9ybV9faW5wdXRcIik7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gIH1cblxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgdGhpcy5fZm9ybVZhbHVlcyA9IHt9O1xuXG4gICAgdGhpcy5fZm9ybUlucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgdGhpcy5fZm9ybVZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xuICAgIH0pO1xuICAgIHJldHVybiB0aGlzLl9mb3JtVmFsdWVzO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9KTtcbiAgfVxuXG4gIHJlc2V0Rm9ybSgpIHtcbiAgICB0aGlzLl9mb3JtLnJlc2V0KCk7XG4gIH1cbn1cbiIsIi8vbG9jYWwgaW1hZ2VzXG5jb25zdCBUcmFtd2F5ID0gcmVxdWlyZShcIi4uL2ltYWdlcy9QYWxtLVNwcmluZ3MtQWVyaWFsLVRyYW13YXktY29sb3JmaXguanBnXCIpO1xuY29uc3QgQ2VkYXJQdCA9IHJlcXVpcmUoXCIuLi9pbWFnZXMvQ29ya3NjcmV3XyhDZWRhcl9Qb2ludClfMDEuanBnXCIpO1xuY29uc3QgUG93V293ID0gcmVxdWlyZShcIi4uL2ltYWdlcy9qZXNzLWxpbmRuZXIteGVneURuMS1Tb1ktdW5zcGxhc2gtY29sb3JmaXguanBnXCIpO1xuY29uc3QgQ29sV2lsbGlhbXNidXJnID0gcmVxdWlyZShcIi4uL2ltYWdlcy9Db2xvbmlhbC1XaWxsaWFtc2J1cmctVmlyZ2luaWFzaXplZml4LTIuanBnXCIpO1xuY29uc3QgUHVlcnRvUmljbyA9IHJlcXVpcmUoXCIuLi9pbWFnZXMvamVubmlmZXItY2hlbi15WEppQzJVaklCby11bnNwbGFzaC1jb2xvcmZpeC5qcGdcIik7XG5jb25zdCBEaXNuZXlXb3JsZCA9IHJlcXVpcmUoXCIuLi9pbWFnZXMvc2FuZHJvLWdvbnphbGV6LWRCRUpHNmh2MjI0LXVuc3BsYXNoLmpwZ1wiKTtcblxuLy9sb29wIGZvciBpbml0aWFsIGNhcmRzXG5leHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xuICB7XG4gICAgdGl0bGU6IFwiUGFsbSBTcHJpbmdzIEFlcmlhbCBUcmFtd2F5XCIsXG4gICAgdXJsOiBUcmFtd2F5LFxuICB9LFxuICB7XG4gICAgdGl0bGU6IFwiQ2VkYXIgUG9pbnQsIE9IXCIsXG4gICAgdXJsOiBDZWRhclB0LFxuICB9LFxuICB7XG4gICAgdGl0bGU6IFwiTi5BLiBQb3cgV293c1wiLFxuICAgIHVybDogUG93V293LFxuICB9LFxuICB7XG4gICAgdGl0bGU6IFwiQ29sb25pYWwgV2lsbGlhbXNidXJnXCIsXG4gICAgdXJsOiBDb2xXaWxsaWFtc2J1cmcsXG4gIH0sXG4gIHtcbiAgICB0aXRsZTogXCJPbGQgU2FuIEp1YW4sIFB1ZXJ0byBSaWNvXCIsXG4gICAgdXJsOiBQdWVydG9SaWNvLFxuICB9LFxuICB7XG4gICAgdGl0bGU6IFwiRGlzbmV5IFdvcmxkXCIsXG4gICAgdXJsOiBEaXNuZXlXb3JsZCxcbiAgfSxcbl07XG5cbmV4cG9ydCBjb25zdCB2YWxpZGF0aW9uQ29uZmlnID0ge1xuICBmb3JtU2VsZWN0b3I6IFwiLnBvcHVwLWZvcm1fX2lucHV0LWNvbnRhaW5lclwiLFxuICBpbnB1dFNlbGVjdG9yOiBcIi5wb3B1cC1mb3JtX19pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIuc3VibWl0LWJ1dHRvblwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcInBvcHVwLWZvcm1fX3N1Ym1pdC1idXR0b25fdHlwZV9kaXNhYmxlZFwiLFxuICBlcnJvclRleHRTZWxlY3RvcjogXCIucG9wdXAtZm9ybV9fZXJyb3ItdGV4dFwiLFxuICBpbnB1dEhhc0Vycm9yOiBcInBvcHVwLWZvcm1fX2lucHV0X2hhc19lcnJvclwiLFxuICBlcnJvclRleHRWaXNpYmxlOiBcInBvcHVwLWZvcm1fX2Vycm9yLXRleHRfdmlzaWJsZVwiLFxufTtcbiIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7XG5cbmltcG9ydCB7IEZvcm1WYWxpZGF0b3IgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5pbXBvcnQgeyBDYXJkIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcbmltcG9ydCBQb3B1cFdpdGhEZWxldGVDb25maXJtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aERlbGV0ZUNvbmZpcm0uanNcIjtcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XG5cbmltcG9ydCB7XG4gIGluaXRpYWxDYXJkcyxcbiAgdmFsaWRhdGlvbkNvbmZpZyxcbn0gZnJvbSBcIi4uL3V0aWxzL0NvbnN0YW50cy5qc1wiO1xuXG4vL2J1dHRvbnNcbmNvbnN0IGVkaXRQcm9maWxlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LWJ1dHRvblwiKTtcbmNvbnN0IGFkZENhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmFkZC1idXR0b25cIik7XG5jb25zdCBlZGl0UHJvZmlsZVBpY0J1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1waWMtYnV0dG9uXCIpO1xuXG5cblxuLy9pbnB1dHNcbmNvbnN0IGlucHV0TmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbmFtZVwiKTtcbmNvbnN0IGlucHV0Sm9iID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNkZXNjcmlwdGlvblwiKTtcbmNvbnN0IGlucHV0UGljdHVyZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1waWNcIik7XG5cblxuY29uc3QgYXBpID0gbmV3IEFwaSh7XG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cC0xMlwiLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogXCI5Yjk5MWY4Ni0zNjhkLTRlZjMtOTYzYy1iOTE1ODA4MjFjNDZcIixcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgfVxufSlcblxuXG5jb25zdCBpbWFnZVBvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiaW1hZ2UtcG9wdXBcIik7XG5cbmNvbnN0IGNyZWF0ZUNhcmQgPSAoZGF0YSkgPT4ge1xuICBjb25zdCBjYXJkID0gbmV3IENhcmQoXG4gICAge1xuICAgICAgZGF0YSxcbiAgICAgIGhhbmRsZUNhcmRDbGljazogKCkgPT4ge1xuICAgICAgICBpbWFnZVBvcHVwLm9wZW4oZGF0YSlcbiAgICAgIH0sXG4gICAgICBoYW5kbGVUcmFzaENsaWNrOiAoKSA9PiB7XG4gICAgICAgIGRlbGV0ZUNvbmZpcm1Qb3B1cEZvcm0ub3BlbigpO1xuICAgICAgfVxuICAgIH0sXG4gICAgXCJjYXJkLXRlbXBsYXRlXCJcbiAgKTtcbiAgcmV0dXJuIGNhcmQuY3JlYXRlQ2FyZCgpO1xufTtcblxuY29uc3QgY2FyZExpc3QgPSBuZXcgU2VjdGlvbihcbiAge1xuICAgIGl0ZW1zOiBpbml0aWFsQ2FyZHMsXG4gICAgcmVuZGVyZXI6IChkYXRhKSA9PiB7XG4gICAgICBjYXJkTGlzdC5hZGRJdGVtKGNyZWF0ZUNhcmQoZGF0YSkpO1xuICAgIH0sXG4gIH0sXG4gIFwiZWxlbWVudHNcIlxuKTtcblxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xuICBuYW1lU2VsZWN0b3I6IFwicHJvZmlsZV9fbmFtZVwiLFxuICBkZXNjcmlwdGlvblNlbGVjdG9yOiBcInByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIsXG59KTtcblxuY29uc3QgZWRpdFByb2ZpbGVQb3B1cEZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybSh7XG4gIHBvcHVwU2VsZWN0b3I6IFwiZWRpdC1wb3B1cC1mb3JtXCIsXG4gIGhhbmRsZUZvcm1TdWJtaXQ6IChkYXRhKSA9PiB7XG4gICAgdXNlckluZm8uc2V0VXNlckluZm8oZGF0YSk7XG4gIH0sXG59KTtcblxuY29uc3QgY3JlYXRlQ2FyZFBvcHVwRm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcbiAgcG9wdXBTZWxlY3RvcjogXCJjcmVhdGUtcG9wdXAtZm9ybVwiLFxuICBoYW5kbGVGb3JtU3VibWl0OiAoZGF0YSkgPT4ge1xuICAgIGNhcmRMaXN0LmFkZEl0ZW0oY3JlYXRlQ2FyZChkYXRhKSk7XG4gICAgY3JlYXRlQ2FyZFBvcHVwRm9ybS5yZXNldEZvcm0oKTtcbiAgfSxcbn0pO1xuXG5jb25zdCBkZWxldGVDb25maXJtUG9wdXBGb3JtID0gbmV3IFBvcHVwV2l0aERlbGV0ZUNvbmZpcm0oe1xuICBwb3B1cFNlbGVjdG9yOiBcImRlbGV0ZS1jb25maXJtYXRpb24tcG9wdXBcIlxufSk7XG5cbmNvbnN0IHByb2ZpbGVQaWNQb3B1cEZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybSh7XG4gIHBvcHVwU2VsZWN0b3I6IFwicHJvZmlsZS1waWN0dXJlLXBvcHVwXCIsXG4gIGhhbmRsZUZvcm1TdWJtaXQ6ICgpID0+IHtcbiAgICBjb25zdCBwaWN0dXJlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19pbWFnZVwiKTtcbiAgICBwaWN0dXJlLnNyYyA9IGlucHV0UGljdHVyZS52YWx1ZTtcbiAgICBwcm9maWxlUGljUG9wdXBGb3JtLnJlc2V0Rm9ybSgpO1xuICB9XG59KTtcblxuY29uc3QgZWRpdFByb2ZpbGVWYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcbiAgdmFsaWRhdGlvbkNvbmZpZyxcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LXBvcHVwLWZvcm1cIilcbik7XG5lZGl0UHJvZmlsZVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbmNvbnN0IGNyZWF0ZUNhcmRWYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcbiAgdmFsaWRhdGlvbkNvbmZpZyxcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjcmVhdGUtcG9wdXAtZm9ybVwiKVxuKTtcbmNyZWF0ZUNhcmRWYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG5jb25zdCBwcm9maWxlUGljVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXG4gIHZhbGlkYXRpb25Db25maWcsXG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1waWN0dXJlLXBvcHVwXCIpXG4pO1xucHJvZmlsZVBpY1ZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbmVkaXRQcm9maWxlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGVkaXRQcm9maWxlUG9wdXBGb3JtLm9wZW4oKTtcbiAgY29uc3Qge25hbWUsIGRlc2NyaXB0aW9ufSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XG4gIGlucHV0TmFtZS52YWx1ZSA9IG5hbWU7XG4gIGlucHV0Sm9iLnZhbHVlID0gZGVzY3JpcHRpb247XG4gIGVkaXRQcm9maWxlVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xufSk7XG5cbmFkZENhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgY3JlYXRlQ2FyZFBvcHVwRm9ybS5yZXNldEZvcm0oKTtcbiAgY3JlYXRlQ2FyZFZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcbiAgY3JlYXRlQ2FyZFBvcHVwRm9ybS5vcGVuKCk7XG59KTtcblxuZWRpdFByb2ZpbGVQaWNCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgcHJvZmlsZVBpY1ZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcbiAgcHJvZmlsZVBpY1BvcHVwRm9ybS5vcGVuKCk7XG59KVxuXG5cbmNhcmRMaXN0LnJlbmRlckl0ZW0oaW5pdGlhbENhcmRzKTtcbmltYWdlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbmVkaXRQcm9maWxlUG9wdXBGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5jcmVhdGVDYXJkUG9wdXBGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5kZWxldGVDb25maXJtUG9wdXBGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5wcm9maWxlUGljUG9wdXBGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcbiAgICBjb25zdHJ1Y3Rvcih7YmFzZVVybCwgaGVhZGVyc30pIHtcbiAgICAgICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XG4gICAgICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xuICAgIH1cblxuLy8gdXNlZCB0byBnZXQgdGhlIHNlcnZlciByZXNwb25zZVxuICAgIF9oYW5kbGVTZXJ2ZXJSZXNwb25zZShyZXMpIHtcbiAgICAgICAgcmV0dXJuIHJlcy5vayA/IHJlcy5qc29uKCkgOiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICB9XG4gICAgXG4vL3VzZWQgdG8gcmVxdWVzdCB1c2VyIGluZm9cbiAgICBnZXRVc2VySW5mbygpIHtcbiAgICAgICAgZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLH0pXG4gICAgICAgIC50aGVuKHRoaXMuX2hhbmRsZVNlcnZlclJlc3BvbnNlKTtcbiAgICB9XG5cbi8vdXNlZCB0byBpbnNlcnQgdXNlciBpbmZvXG4gICAgc2V0VXNlckluZm8oe25hbWUsIGRlc2NyaXB0aW9ufSkge1xuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICAgICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgbmFtZSxcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvblxuICAgICAgICAgICAgfSksXG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKHRoaXMuX2hhbmRsZVNlcnZlclJlc3BvbnNlKTtcbiAgICB9XG5cbiAvLyB1c2VkIHRvIGluc2VydCBwcm9maWxlIHBpYyAgIFxuICAgIHVwZGF0ZVByb2ZpbGVQaWN0dXJlKHthdmF0YXJ9KSB7XG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICAgICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgYXZhdGFyLFxuICAgICAgICAgICAgfSksXG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKHRoaXMuX2hhbmRsZVNlcnZlclJlc3BvbnNlKTtcbiAgICB9XG5cbiAgLy8gdXNlZCB0byBnZXQgaW5pdGlhbCBjYXJkcyBmcm9tIHNlcnZlciAgXG4gICAgZ2V0SW5pdGlhbENhcmRMaXN0KHt0aXRsZSwgdXJsfSkge1xuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICAgICAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgdGl0bGUsXG4gICAgICAgICAgICAgICAgdXJsXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnRoZW4odGhpcy5faGFuZGxlU2VydmVyUmVzcG9uc2UpXG4gICAgICAgIH0pO1xuICAgIH1cblxuLy8gdXNlZCB0byBhZGQgY2FyZHMgdG8gcGFnZVxuICAgIGFkZENhcmQoe3RpdGxlLCB1cmx9KSB7XG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgIHRpdGxlLFxuICAgICAgICAgICAgICAgIHVybFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC50aGVuKHRoaXMuX2hhbmRsZVNlcnZlclJlc3BvbnNlKVxuICAgICAgICB9KTtcbiAgICB9XG5cbi8vIHJlbW92ZXMgY2FyZHNcbiAgICByZW1vdmVDYXJkKHtfaWR9KSB7XG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9jYXJkSWRgLCB7XG4gICAgICAgICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgIF9pZCxcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAudGhlbih0aGlzLl9oYW5kbGVTZXJ2ZXJSZXNwb25zZSlcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgXG4gICAgdG9nZ2xlTGlrZUNhcmRTdGF0dXMoY2FyZElkLCBsaWtlKSB7XG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XG4gICAgICAgICAgICBtZXRob2Q6IGxpa2UgPyBcIlBVVFwiIDogXCJERUxFVEVcIixcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKHRoaXMuX2hhbmRsZVNlcnZlclJlc3BvbnNlKVxuICAgIH1cblxufSIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gIG9wZW4oeyB1cmwsIHRpdGxlIH0pIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cC1mb3JtX19jYXB0aW9uXCIpLnRleHRDb250ZW50ID1cbiAgICAgIHRpdGxlO1xuICAgIHRoaXMuX2ltZ0VsZW1lbnQgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cC1mb3JtX19pbWFnZVwiKTtcbiAgICB0aGlzLl9pbWdFbGVtZW50LnNyYyA9IHVybDtcbiAgICB0aGlzLl9pbWdFbGVtZW50LmFsdCA9IHRpdGxlO1xuXG4gICAgc3VwZXIub3BlbigpO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLiR7Y29udGFpbmVyU2VsZWN0b3J9YCk7XG4gIH1cbiAgLy8gbG9vcHMgdGhyb3VnaCBlYWNoIG9mIHRoZSBpdGVtcyB0aGF0IHdlcmUgY2FsbGVkIGluIGFuZCBjYWxscyB0aGUgcmVuZGVyZXIgb24gdGhhdCBpdGVtXG4gIHJlbmRlckl0ZW0oKSB7XG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XG4gICAgfSk7XG4gIH1cblxuICBhZGRJdGVtKGVsZW1lbnQpIHtcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3Rvcih7IG5hbWVTZWxlY3RvciwgZGVzY3JpcHRpb25TZWxlY3RvciB9KSB7XG4gICAgdGhpcy5fbmFtZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAuJHtuYW1lU2VsZWN0b3J9YCk7XG4gICAgdGhpcy5fZGVzY3JpcHRpb25FbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLiR7ZGVzY3JpcHRpb25TZWxlY3Rvcn1gKTtcbiAgfVxuICAvL3JldHVybnMgYW4gb2JqZWN0IHdpdGggaW5mbyBhYm91dCB0aGUgdXNlclxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQsXG4gICAgICBkZXNjcmlwdGlvbjogdGhpcy5fZGVzY3JpcHRpb25FbGVtZW50LnRleHRDb250ZW50LFxuICAgIH07XG4gIH1cbiAgLy90YWtlcyBuZXcgdXNlciBkYXRhIGFuZCBhZGRzIGl0IG9uIHRoZSBwYWdlXG4gIHNldFVzZXJJbmZvKHsgbmFtZSwgZGVzY3JpcHRpb24gfSkge1xuICAgIHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50ID0gbmFtZTtcbiAgICB0aGlzLl9kZXNjcmlwdGlvbkVsZW1lbnQudGV4dENvbnRlbnQgPSBkZXNjcmlwdGlvbjtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aERlbGV0ZUNvbmZpcm0gZXh0ZW5kcyBQb3B1cCB7XG4gICAgY29uc3RydWN0b3Ioe3BvcHVwU2VsZWN0b3J9KSB7XG4gICAgICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIH1cblxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgICAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuXG4gICAgICAgIGNvbnN0IGRlbGV0ZUNvbmZpcm1CdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NvbmZpcm1hdGlvbi1idXR0b25cIik7XG5cbiAgICAgICAgZGVsZXRlQ29uZmlybUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5kZWxldGVDYXJkKCk7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGRlbGV0ZUNhcmQoKSB7XG4gICAgICAgIGNvbnN0IGNhcmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRcIik7XG4gICAgICAgIGNhcmQucmVtb3ZlKCk7XG4gICAgfVxufVxuIl0sIm5hbWVzIjpbIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImNhY2hlZE1vZHVsZSIsInVuZGVmaW5lZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJfX3dlYnBhY2tfbW9kdWxlc19fIiwicCIsIkZvcm1WYWxpZGF0b3IiLCJjb25zdHJ1Y3RvciIsImNvbmZpZyIsImZvcm1FbGVtZW50IiwidGhpcyIsIl9jb25maWciLCJfZm9ybUVsZW1lbnQiLCJlbmFibGVWYWxpZGF0aW9uIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJfaW5wdXRzIiwicXVlcnlTZWxlY3RvckFsbCIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnRuIiwicXVlcnlTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiZm9yRWFjaCIsImlucHV0IiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2dCIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJfdXBkYXRlU3VibWl0QnV0dG9uIiwiaGFzRXJyb3JzIiwiX2NoZWNrRmllbGRzVmFsaWRpdHkiLCJfc2V0U3VibWl0QnV0dG9uU3RhdGUiLCJkaXNhYmxlZCIsIkFycmF5IiwiZnJvbSIsInNvbWUiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX3JlbW92ZUVycm9yU3R5bGVzIiwiX2hpZGVFcnJvck1lc3NhZ2UiLCJfYWRkRXJyb3JTdHlsZXMiLCJfc2hvd0Vycm9yTWVzc2FnZSIsImNsYXNzTGlzdCIsInJlbW92ZSIsImlucHV0SGFzRXJyb3IiLCJpZCIsImVycm9yVGV4dFZpc2libGUiLCJhZGQiLCJlcnJvck1lc3NhZ2VFbGVtZW50IiwidGV4dENvbnRlbnQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsInJlc2V0VmFsaWRhdGlvbiIsIkNhcmQiLCJ0ZW1wbGF0ZVNlbGVjdG9yIiwiZGF0YSIsImhhbmRsZUNhcmRDbGljayIsImhhbmRsZVRyYXNoQ2xpY2siLCJfdGVtcGxhdGUiLCJkb2N1bWVudCIsIl9kYXRhIiwiX2hhbmRsZUNhcmRDbGljayIsIl9oYW5kbGVUcmFzaENsaWNrIiwiY3JlYXRlQ2FyZCIsIl9jYXJkIiwiY29udGVudCIsImNsb25lTm9kZSIsInRpdGxlRWxlbWVudCIsImltZ0VsZW1lbnQiLCJzcmMiLCJ1cmwiLCJhbHQiLCJ0aXRsZSIsIl9zZXRFdmVudExpc3RlbmVycyIsIl90b2dnbGVMaWtlIiwidG9nZ2xlIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsIl9oYW5kbGVFc2NDbG9zZSIsImJpbmQiLCJvcGVuIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZSIsImtleSIsInRhcmdldCIsImNvbnRhaW5zIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9mb3JtIiwiX2Zvcm1JbnB1dHMiLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9nZXRJbnB1dFZhbHVlcyIsIl9mb3JtVmFsdWVzIiwibmFtZSIsInZhbHVlIiwicHJldmVudERlZmF1bHQiLCJyZXNldEZvcm0iLCJyZXNldCIsImluaXRpYWxDYXJkcyIsInJlcXVpcmUiLCJ2YWxpZGF0aW9uQ29uZmlnIiwiZm9ybVNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImVycm9yVGV4dFNlbGVjdG9yIiwiZWRpdFByb2ZpbGVCdXR0b24iLCJhZGRDYXJkQnV0dG9uIiwiZWRpdFByb2ZpbGVQaWNCdXR0b24iLCJpbnB1dE5hbWUiLCJpbnB1dEpvYiIsImlucHV0UGljdHVyZSIsImltYWdlUG9wdXAiLCJiYXNlVXJsIiwiaGVhZGVycyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJfaGFuZGxlU2VydmVyUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0VXNlckluZm8iLCJmZXRjaCIsInRoZW4iLCJzZXRVc2VySW5mbyIsImRlc2NyaXB0aW9uIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJ1cGRhdGVQcm9maWxlUGljdHVyZSIsImF2YXRhciIsImdldEluaXRpYWxDYXJkTGlzdCIsImFkZENhcmQiLCJyZW1vdmVDYXJkIiwiX2lkIiwidG9nZ2xlTGlrZUNhcmRTdGF0dXMiLCJjYXJkSWQiLCJsaWtlIiwiYXV0aG9yaXphdGlvbiIsIl9pbWdFbGVtZW50IiwiZGVsZXRlQ29uZmlybVBvcHVwRm9ybSIsImNhcmRMaXN0IiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW0iLCJpdGVtIiwiYWRkSXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwidXNlckluZm8iLCJuYW1lU2VsZWN0b3IiLCJkZXNjcmlwdGlvblNlbGVjdG9yIiwiX25hbWVFbGVtZW50IiwiX2Rlc2NyaXB0aW9uRWxlbWVudCIsImVkaXRQcm9maWxlUG9wdXBGb3JtIiwiY3JlYXRlQ2FyZFBvcHVwRm9ybSIsImRlbGV0ZUNhcmQiLCJwcm9maWxlUGljUG9wdXBGb3JtIiwiZWRpdFByb2ZpbGVWYWxpZGF0b3IiLCJjcmVhdGVDYXJkVmFsaWRhdG9yIiwicHJvZmlsZVBpY1ZhbGlkYXRvciJdLCJzb3VyY2VSb290IjoiIn0=